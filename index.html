<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coffee Dashboard - Albert.Chou</title>
    <style>
        /* Theme Variables */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --text-primary: #000000;
            --text-secondary: #333333;
            --border-color: #cccccc;
            --accent-color: #4a90e2;
            --accent-hover: #357abd;
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --table-header-bg: #e0e0e0;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2a2a2a;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --border-color: #404040;
            --accent-color: #64b5f6;
            --accent-hover: #42a5f5;
            --card-bg: #2a2a2a;
            --input-bg: #333333;
            --table-header-bg: #404040;
            --shadow: rgba(0, 0, 0, 0.5);
        }

        [data-theme="light"] {
            --bg-primary: #f8f9fa;
            --bg-secondary: #e9ecef;
            --text-primary: #212529;
            --text-secondary: #495057;
            --border-color: #dee2e6;
            --accent-color: #007bff;
            --accent-hover: #0056b3;
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --table-header-bg: #e9ecef;
            --shadow: rgba(0, 0, 0, 0.08);
        }

        [data-theme="black"] {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --border-color: #333333;
            --accent-color: #00ff88;
            --accent-hover: #00cc6a;
            --card-bg: #0a0a0a;
            --input-bg: #1a1a1a;
            --table-header-bg: #1a1a1a;
            --shadow: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px var(--shadow);
            border: 1px solid var(--border-color);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }

        .title-section h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .version-info {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: var(--accent-color);
            color: white;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px var(--shadow);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
        }

        select {
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        select:hover {
            border-color: var(--accent-color);
        }

        .info-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .info-card {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .info-card h3 {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .info-card p {
            font-size: 1em;
            font-weight: 500;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px var(--shadow);
            border: 1px solid var(--border-color);
        }

        .card h2 {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent-color);
            font-size: 1.5em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--text-primary);
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .result-table th,
        .result-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        .result-table th {
            background: var(--table-header-bg);
            font-weight: 600;
        }

        .result-table tr:hover {
            background: var(--bg-secondary);
        }

        .export-section {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .feature-list {
            list-style: none;
        }

        .feature-list li {
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .feature-list li:last-child {
            border-bottom: none;
        }

        .feature-list li::before {
            content: "âœ“ ";
            color: var(--accent-color);
            font-weight: bold;
            margin-right: 8px;
        }

        .usage-steps {
            counter-reset: step-counter;
            list-style: none;
        }

        .usage-steps li {
            counter-increment: step-counter;
            padding: 15px 0;
            padding-left: 40px;
            position: relative;
        }

        .usage-steps li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 15px;
            width: 30px;
            height: 30px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
            border-top: 1px solid var(--border-color);
            margin-top: 30px;
        }

        .param-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--accent-color);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px var(--shadow);
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .horizontal-table {
            width: 100%;
            overflow-x: auto;
        }

        .horizontal-table table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .horizontal-table th,
        .horizontal-table td {
            padding: 12px;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .horizontal-table th {
            background: var(--table-header-bg);
            font-weight: 600;
        }

        .input-cell input {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--input-bg);
            color: var(--text-primary);
            text-align: center;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card {
            animation: fadeIn 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div class="title-section">
                    <h1 id="appTitle">â˜• Coffee Dashboard</h1>
                    <div class="version-info">
                        <span id="versionLabel">Version</span>: 3.0.0 | 
                        <span id="designerLabel">Designer</span>: Albert.Chou | 
                        <span id="dateTime"></span>
                    </div>
                </div>
                <div class="controls">
                    <select id="languageSelector" onchange="changeLanguage()">
                        <option value="zh">ä¸­æ–‡</option>
                        <option value="en">English</option>
                        <option value="jp">æ—¥æœ¬èª</option>
                    </select>
                    <select id="themeSelector" onchange="changeTheme()">
                        <option value="light" data-zh="æ·ºè‰²ä¸»é¡Œ" data-en="Light Theme" data-jp="ãƒ©ã‚¤ãƒˆãƒ†ãƒ¼ãƒ">æ·ºè‰²ä¸»é¡Œ</option>
                        <option value="dark" data-zh="æ·±è‰²ä¸»é¡Œ" data-en="Dark Theme" data-jp="ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ">æ·±è‰²ä¸»é¡Œ</option>
                        <option value="white" data-zh="ç™½åº•é»‘å­—" data-en="White Background" data-jp="ç™½èƒŒæ™¯">ç™½åº•é»‘å­—</option>
                        <option value="black" data-zh="é»‘åº•ç™½å­—" data-en="Black Background" data-jp="é»’èƒŒæ™¯">é»‘åº•ç™½å­—</option>
                    </select>
                    <button class="btn" onclick="saveSettings()" id="saveSettingsBtn">ğŸ’¾ å„²å­˜è¨­å®š</button>
                </div>
            </div>

            <div class="info-section">
                <div class="info-card">
                    <h3 id="updateDateLabel">æ›´æ–°æ—¥æœŸ</h3>
                    <p>2025-12-31</p>
                </div>
                <div class="info-card">
                    <h3 id="entranceInfoLabel">é€²ç‰ˆè³‡è¨Š</h3>
                    <p>Coffee Dashboard v3.0</p>
                </div>
                <div class="info-card">
                    <h3 id="designStyleLabel">è¨­è¨ˆé¢¨æ ¼</h3>
                    <p id="designStyleText">ç¾ä»£ç§‘æŠ€é¢¨æ ¼</p>
                </div>
            </div>
        </header>

        <div class="main-content">
            <div class="card">
                <h2 id="featuresTitle">ğŸ“‹ åŠŸèƒ½èªªæ˜</h2>
                <ul class="feature-list" id="featureList">
                    <li>å’–å•¡èƒå–åƒæ•¸è¨ˆç®—èˆ‡å»ºè­°</li>
                    <li>å³æ™‚è¨ˆç®—å’–å•¡è±†ã€æ°´ã€æ™‚é–“æ¯”ä¾‹</li>
                    <li>å¤šèªè¨€ä»‹é¢åˆ‡æ› (ä¸­/è‹±/æ—¥)</li>
                    <li>å¤šä¸»é¡Œé…è‰²æ–¹æ¡ˆ</li>
                    <li>åŒ¯å‡ºåŠŸèƒ½ (ZIP/Excel/CSV/HTML)</li>
                    <li>åƒæ•¸è¨­å®šå„²å­˜åŠŸèƒ½</li>
                    <li>éŸ¿æ‡‰å¼è¨­è¨ˆï¼Œæ”¯æ´å„ç¨®è£ç½®</li>
                </ul>
            </div>

            <div class="card">
                <h2 id="usageTitle">ğŸ”„ ä½¿ç”¨æµç¨‹</h2>
                <ol class="usage-steps" id="usageSteps">
                    <li>é¸æ“‡å’–å•¡è±†ç¨®é¡èˆ‡çƒ˜ç„™ç¨‹åº¦</li>
                    <li>è¨­å®šå’–å•¡è±†é‡é‡ (å…‹)</li>
                    <li>è¼¸å…¥èƒå–æ°´é‡ (æ¯«å‡)</li>
                    <li>è¨­å®šèƒå–æ™‚é–“èˆ‡æº«åº¦</li>
                    <li>æŸ¥çœ‹è¨ˆç®—çµæœèˆ‡å»ºè­°</li>
                    <li>å¯åŒ¯å‡ºè³‡æ–™æˆ–å„²å­˜è¨­å®š</li>
                </ol>
            </div>
        </div>

        <div class="card">
            <h2 id="parametersTitle">âš™ï¸ å¯ä¿®æ”¹åƒæ•¸</h2>
            <div class="horizontal-table">
                <table>
                    <thead>
                        <tr>
                            <th id="paramBeanType">è±†ç¨®é¡å‹</th>
                            <th id="paramRoastLevel">çƒ˜ç„™ç¨‹åº¦</th>
                            <th id="paramBeanWeight">è±†é‡ (g)</th>
                            <th id="paramWaterVolume">æ°´é‡ (ml)</th>
                            <th id="paramBrewTime">æ™‚é–“ (ç§’)</th>
                            <th id="paramTemperature">æº«åº¦ (Â°C)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="input-cell">
                                <select id="beanType" onchange="calculate()">
                                    <option value="arabica" data-zh="é˜¿æ‹‰æ¯”å¡" data-en="Arabica" data-jp="ã‚¢ãƒ©ãƒ“ã‚«">é˜¿æ‹‰æ¯”å¡</option>
                                    <option value="robusta" data-zh="ç¾…å¸ƒæ–¯å¡”" data-en="Robusta" data-jp="ãƒ­ãƒ–ã‚¹ã‚¿">ç¾…å¸ƒæ–¯å¡”</option>
                                    <option value="blend" data-zh="æ··åˆ" data-en="Blend" data-jp="ãƒ–ãƒ¬ãƒ³ãƒ‰">æ··åˆ</option>
                                </select>
                            </td>
                            <td class="input-cell">
                                <select id="roastLevel" onchange="calculate()">
                                    <option value="light" data-zh="æ·ºç„™" data-en="Light" data-jp="ãƒ©ã‚¤ãƒˆ">æ·ºç„™</option>
                                    <option value="medium" data-zh="ä¸­ç„™" data-en="Medium" data-jp="ãƒŸãƒ‡ã‚£ã‚¢ãƒ " selected>ä¸­ç„™</option>
                                    <option value="dark" data-zh="æ·±ç„™" data-en="Dark" data-jp="ãƒ€ãƒ¼ã‚¯">æ·±ç„™</option>
                                </select>
                            </td>
                            <td class="input-cell">
                                <input type="number" id="beanWeight" value="18" min="5" max="50" onchange="calculate()">
                            </td>
                            <td class="input-cell">
                                <input type="number" id="waterVolume" value="250" min="100" max="500" onchange="calculate()">
                            </td>
                            <td class="input-cell">
                                <input type="number" id="brewTime" value="180" min="60" max="360" onchange="calculate()">
                            </td>
                            <td class="input-cell">
                                <input type="number" id="temperature" value="93" min="80" max="100" onchange="calculate()">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card">
            <h2 id="resultsTitle">ğŸ“Š è¨ˆç®—çµæœ</h2>
            <table class="result-table" id="resultsTable">
                <thead>
                    <tr>
                        <th id="resultParamHeader">åƒæ•¸</th>
                        <th id="resultValueHeader">æ•¸å€¼</th>
                        <th id="resultRecommendHeader">å»ºè­°ç¯„åœ</th>
                    </tr>
                </thead>
                <tbody id="resultsBody">
                    <!-- Results will be populated by JavaScript -->
                </tbody>
            </table>

            <div class="export-section">
                <button class="btn" onclick="exportToExcel()" id="exportExcelBtn">ğŸ“Š Excel</button>
                <button class="btn" onclick="exportToCSV()" id="exportCSVBtn">ğŸ“„ CSV</button>
                <button class="btn" onclick="exportToHTML()" id="exportHTMLBtn">ğŸŒ HTML</button>
                <button class="btn" onclick="exportToZIP()" id="exportZIPBtn">ğŸ“¦ ZIP</button>
            </div>
        </div>

        <footer>
            <p>Â© 2025 Albert.Chou Design. All rights reserved.</p>
            <p id="footerTech">ç¾ä»£ç§‘æŠ€é¢¨æ ¼è¨­è¨ˆ | Coffee Dashboard v3.0.0</p>
        </footer>
    </div>

    <div class="notification" id="notification"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" integrity="sha512-r22gChDnGvBylk90+2e/ycr+equG0SPwSWD1WRv4W3Gx4xm/dqxnC5wGOZ9T+2P6zMPcqXdqjNJ4GXc+eKbUfQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" integrity="sha512-XMVd28F1oH/O71fzwBnV7HucLxVwtxf26XV8P4wPk26EDxuGZ91N8bsOttmnomcCD3CS5ZMRL50H0GgOHvegtg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        // Translation object
        const translations = {
            zh: {
                appTitle: "â˜• Coffee Dashboard",
                versionLabel: "ç‰ˆæœ¬",
                designerLabel: "è¨­è¨ˆè€…",
                updateDateLabel: "æ›´æ–°æ—¥æœŸ",
                entranceInfoLabel: "é€²ç‰ˆè³‡è¨Š",
                designStyleLabel: "è¨­è¨ˆé¢¨æ ¼",
                designStyleText: "ç¾ä»£ç§‘æŠ€é¢¨æ ¼",
                featuresTitle: "ğŸ“‹ åŠŸèƒ½èªªæ˜",
                usageTitle: "ğŸ”„ ä½¿ç”¨æµç¨‹",
                parametersTitle: "âš™ï¸ å¯ä¿®æ”¹åƒæ•¸",
                resultsTitle: "ğŸ“Š è¨ˆç®—çµæœ",
                saveSettingsBtn: "ğŸ’¾ å„²å­˜è¨­å®š",
                exportExcelBtn: "ğŸ“Š Excel",
                exportCSVBtn: "ğŸ“„ CSV",
                exportHTMLBtn: "ğŸŒ HTML",
                exportZIPBtn: "ğŸ“¦ ZIP",
                footerTech: "ç¾ä»£ç§‘æŠ€é¢¨æ ¼è¨­è¨ˆ | Coffee Dashboard v3.0.0",
                features: [
                    "å’–å•¡èƒå–åƒæ•¸è¨ˆç®—èˆ‡å»ºè­°",
                    "å³æ™‚è¨ˆç®—å’–å•¡è±†ã€æ°´ã€æ™‚é–“æ¯”ä¾‹",
                    "å¤šèªè¨€ä»‹é¢åˆ‡æ› (ä¸­/è‹±/æ—¥)",
                    "å¤šä¸»é¡Œé…è‰²æ–¹æ¡ˆ",
                    "åŒ¯å‡ºåŠŸèƒ½ (ZIP/Excel/CSV/HTML)",
                    "åƒæ•¸è¨­å®šå„²å­˜åŠŸèƒ½",
                    "éŸ¿æ‡‰å¼è¨­è¨ˆï¼Œæ”¯æ´å„ç¨®è£ç½®"
                ],
                usage: [
                    "é¸æ“‡å’–å•¡è±†ç¨®é¡èˆ‡çƒ˜ç„™ç¨‹åº¦",
                    "è¨­å®šå’–å•¡è±†é‡é‡ (å…‹)",
                    "è¼¸å…¥èƒå–æ°´é‡ (æ¯«å‡)",
                    "è¨­å®šèƒå–æ™‚é–“èˆ‡æº«åº¦",
                    "æŸ¥çœ‹è¨ˆç®—çµæœèˆ‡å»ºè­°",
                    "å¯åŒ¯å‡ºè³‡æ–™æˆ–å„²å­˜è¨­å®š"
                ],
                paramBeanType: "è±†ç¨®é¡å‹",
                paramRoastLevel: "çƒ˜ç„™ç¨‹åº¦",
                paramBeanWeight: "è±†é‡ (g)",
                paramWaterVolume: "æ°´é‡ (ml)",
                paramBrewTime: "æ™‚é–“ (ç§’)",
                paramTemperature: "æº«åº¦ (Â°C)",
                resultParamHeader: "åƒæ•¸",
                resultValueHeader: "æ•¸å€¼",
                resultRecommendHeader: "å»ºè­°ç¯„åœ",
                resultRatio: "å’–å•¡æ¯”ä¾‹",
                resultStrength: "æ¿ƒåº¦è©•ä¼°",
                resultQuality: "å“è³ªè©•åˆ†",
                resultSuggestion: "èƒå–å»ºè­°",
                settingsSaved: "è¨­å®šå·²å„²å­˜ï¼",
                exportSuccess: "åŒ¯å‡ºæˆåŠŸï¼"
            },
            en: {
                appTitle: "â˜• Coffee Dashboard",
                versionLabel: "Version",
                designerLabel: "Designer",
                updateDateLabel: "Update Date",
                entranceInfoLabel: "Entry Info",
                designStyleLabel: "Design Style",
                designStyleText: "Modern Tech Style",
                featuresTitle: "ğŸ“‹ Features",
                usageTitle: "ğŸ”„ Usage Flow",
                parametersTitle: "âš™ï¸ Parameters",
                resultsTitle: "ğŸ“Š Results",
                saveSettingsBtn: "ğŸ’¾ Save Settings",
                exportExcelBtn: "ğŸ“Š Excel",
                exportCSVBtn: "ğŸ“„ CSV",
                exportHTMLBtn: "ğŸŒ HTML",
                exportZIPBtn: "ğŸ“¦ ZIP",
                footerTech: "Modern Tech Design | Coffee Dashboard v3.0.0",
                features: [
                    "Coffee extraction parameter calculation",
                    "Real-time bean, water, time ratio calculation",
                    "Multi-language interface (CN/EN/JP)",
                    "Multiple theme color schemes",
                    "Export functionality (ZIP/Excel/CSV/HTML)",
                    "Parameter settings save function",
                    "Responsive design for all devices"
                ],
                usage: [
                    "Select coffee bean type and roast level",
                    "Set coffee bean weight (grams)",
                    "Input water volume (milliliters)",
                    "Set brewing time and temperature",
                    "View calculation results and recommendations",
                    "Export data or save settings"
                ],
                paramBeanType: "Bean Type",
                paramRoastLevel: "Roast Level",
                paramBeanWeight: "Bean (g)",
                paramWaterVolume: "Water (ml)",
                paramBrewTime: "Time (sec)",
                paramTemperature: "Temp (Â°C)",
                resultParamHeader: "Parameter",
                resultValueHeader: "Value",
                resultRecommendHeader: "Recommended Range",
                resultRatio: "Coffee Ratio",
                resultStrength: "Strength",
                resultQuality: "Quality Score",
                resultSuggestion: "Brew Suggestion",
                settingsSaved: "Settings saved!",
                exportSuccess: "Export successful!"
            },
            jp: {
                appTitle: "â˜• Coffee Dashboard",
                versionLabel: "ãƒãƒ¼ã‚¸ãƒ§ãƒ³",
                designerLabel: "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼",
                updateDateLabel: "æ›´æ–°æ—¥",
                entranceInfoLabel: "ã‚¨ãƒ³ãƒˆãƒªãƒ¼æƒ…å ±",
                designStyleLabel: "ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«",
                designStyleText: "ãƒ¢ãƒ€ãƒ³ãƒ†ãƒƒã‚¯ã‚¹ã‚¿ã‚¤ãƒ«",
                featuresTitle: "ğŸ“‹ æ©Ÿèƒ½èª¬æ˜",
                usageTitle: "ğŸ”„ ä½¿ç”¨ãƒ•ãƒ­ãƒ¼",
                parametersTitle: "âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿",
                resultsTitle: "ğŸ“Š è¨ˆç®—çµæœ",
                saveSettingsBtn: "ğŸ’¾ è¨­å®šã‚’ä¿å­˜",
                exportExcelBtn: "ğŸ“Š Excel",
                exportCSVBtn: "ğŸ“„ CSV",
                exportHTMLBtn: "ğŸŒ HTML",
                exportZIPBtn: "ğŸ“¦ ZIP",
                footerTech: "ãƒ¢ãƒ€ãƒ³ãƒ†ãƒƒã‚¯ãƒ‡ã‚¶ã‚¤ãƒ³ | Coffee Dashboard v3.0.0",
                features: [
                    "ã‚³ãƒ¼ãƒ’ãƒ¼æŠ½å‡ºãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨ˆç®—",
                    "ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è±†ãƒ»æ°´ãƒ»æ™‚é–“æ¯”ç‡è¨ˆç®—",
                    "å¤šè¨€èªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆä¸­/è‹±/æ—¥ï¼‰",
                    "è¤‡æ•°ã®ãƒ†ãƒ¼ãƒã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ ",
                    "ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆZIP/Excel/CSV/HTMLï¼‰",
                    "ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šä¿å­˜æ©Ÿèƒ½",
                    "ã™ã¹ã¦ã®ãƒ‡ãƒã‚¤ã‚¹å¯¾å¿œãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³"
                ],
                usage: [
                    "ã‚³ãƒ¼ãƒ’ãƒ¼è±†ã®ç¨®é¡ã¨ç„™ç…åº¦ã‚’é¸æŠ",
                    "ã‚³ãƒ¼ãƒ’ãƒ¼è±†ã®é‡é‡ã‚’è¨­å®šï¼ˆã‚°ãƒ©ãƒ ï¼‰",
                    "æ°´é‡ã‚’å…¥åŠ›ï¼ˆãƒŸãƒªãƒªãƒƒãƒˆãƒ«ï¼‰",
                    "æŠ½å‡ºæ™‚é–“ã¨æ¸©åº¦ã‚’è¨­å®š",
                    "è¨ˆç®—çµæœã¨æ¨å¥¨äº‹é …ã‚’ç¢ºèª",
                    "ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã¾ãŸã¯è¨­å®šã‚’ä¿å­˜"
                ],
                paramBeanType: "è±†ã®ç¨®é¡",
                paramRoastLevel: "ç„™ç…åº¦",
                paramBeanWeight: "è±† (g)",
                paramWaterVolume: "æ°´ (ml)",
                paramBrewTime: "æ™‚é–“ (ç§’)",
                paramTemperature: "æ¸©åº¦ (Â°C)",
                resultParamHeader: "ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿",
                resultValueHeader: "å€¤",
                resultRecommendHeader: "æ¨å¥¨ç¯„å›²",
                resultRatio: "ã‚³ãƒ¼ãƒ’ãƒ¼æ¯”ç‡",
                resultStrength: "æ¿ƒåº¦è©•ä¾¡",
                resultQuality: "å“è³ªã‚¹ã‚³ã‚¢",
                resultSuggestion: "æŠ½å‡ºæ¨å¥¨",
                settingsSaved: "è¨­å®šãŒä¿å­˜ã•ã‚Œã¾ã—ãŸï¼",
                exportSuccess: "ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæˆåŠŸï¼"
            }
        };

        let currentLanguage = 'zh';
        let currentTheme = 'light';

        // Initialize
        window.onload = function() {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            loadSettings();
            calculate();
        };

        function updateDateTime() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit', 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: false
            };
            const localeMap = { zh: 'zh-TW', en: 'en-US', jp: 'ja-JP' };
            document.getElementById('dateTime').textContent = now.toLocaleString(localeMap[currentLanguage] || 'zh-TW', options);
        }

        function changeLanguage() {
            currentLanguage = document.getElementById('languageSelector').value;
            const t = translations[currentLanguage];

            // Update all text elements
            document.getElementById('appTitle').textContent = t.appTitle;
            document.getElementById('versionLabel').textContent = t.versionLabel;
            document.getElementById('designerLabel').textContent = t.designerLabel;
            document.getElementById('updateDateLabel').textContent = t.updateDateLabel;
            document.getElementById('entranceInfoLabel').textContent = t.entranceInfoLabel;
            document.getElementById('designStyleLabel').textContent = t.designStyleLabel;
            document.getElementById('designStyleText').textContent = t.designStyleText;
            document.getElementById('featuresTitle').textContent = t.featuresTitle;
            document.getElementById('usageTitle').textContent = t.usageTitle;
            document.getElementById('parametersTitle').textContent = t.parametersTitle;
            document.getElementById('resultsTitle').textContent = t.resultsTitle;
            document.getElementById('saveSettingsBtn').textContent = t.saveSettingsBtn;
            document.getElementById('exportExcelBtn').textContent = t.exportExcelBtn;
            document.getElementById('exportCSVBtn').textContent = t.exportCSVBtn;
            document.getElementById('exportHTMLBtn').textContent = t.exportHTMLBtn;
            document.getElementById('exportZIPBtn').textContent = t.exportZIPBtn;
            document.getElementById('footerTech').textContent = t.footerTech;

            // Update parameter headers
            document.getElementById('paramBeanType').textContent = t.paramBeanType;
            document.getElementById('paramRoastLevel').textContent = t.paramRoastLevel;
            document.getElementById('paramBeanWeight').textContent = t.paramBeanWeight;
            document.getElementById('paramWaterVolume').textContent = t.paramWaterVolume;
            document.getElementById('paramBrewTime').textContent = t.paramBrewTime;
            document.getElementById('paramTemperature').textContent = t.paramTemperature;

            // Update result headers
            document.getElementById('resultParamHeader').textContent = t.resultParamHeader;
            document.getElementById('resultValueHeader').textContent = t.resultValueHeader;
            document.getElementById('resultRecommendHeader').textContent = t.resultRecommendHeader;

            // Update features list
            const featureList = document.getElementById('featureList');
            featureList.innerHTML = '';
            t.features.forEach(feature => {
                const li = document.createElement('li');
                li.textContent = feature;
                featureList.appendChild(li);
            });

            // Update usage steps
            const usageSteps = document.getElementById('usageSteps');
            usageSteps.innerHTML = '';
            t.usage.forEach(step => {
                const li = document.createElement('li');
                li.textContent = step;
                usageSteps.appendChild(li);
            });

            // Update select options with data attributes
            updateSelectOptions('beanType');
            updateSelectOptions('roastLevel');
            updateThemeOptions();

            // Recalculate to update results with new language
            calculate();
        }

        function updateSelectOptions(selectId) {
            const select = document.getElementById(selectId);
            Array.from(select.options).forEach(option => {
                const langAttr = 'data-' + currentLanguage;
                if (option.hasAttribute(langAttr)) {
                    option.textContent = option.getAttribute(langAttr);
                }
            });
        }

        function updateThemeOptions() {
            const select = document.getElementById('themeSelector');
            Array.from(select.options).forEach(option => {
                const langAttr = 'data-' + currentLanguage;
                if (option.hasAttribute(langAttr)) {
                    option.textContent = option.getAttribute(langAttr);
                }
            });
        }

        function changeTheme() {
            const theme = document.getElementById('themeSelector').value;
            currentTheme = theme;
            
            if (theme === 'white') {
                document.body.removeAttribute('data-theme');
            } else {
                document.body.setAttribute('data-theme', theme);
            }
        }

        function calculate() {
            const beanWeight = parseFloat(document.getElementById('beanWeight').value);
            const waterVolume = parseFloat(document.getElementById('waterVolume').value);
            const brewTime = parseFloat(document.getElementById('brewTime').value);
            const temperature = parseFloat(document.getElementById('temperature').value);

            const ratio = (waterVolume / beanWeight).toFixed(1);
            const t = translations[currentLanguage];

            // Calculate strength (æ¿ƒåº¦)
            let strength = '';
            if (ratio < 12) {
                strength = currentLanguage === 'zh' ? 'æ¿ƒ' : currentLanguage === 'en' ? 'Strong' : 'æ¿ƒã„';
            } else if (ratio <= 16) {
                strength = currentLanguage === 'zh' ? 'é©ä¸­' : currentLanguage === 'en' ? 'Medium' : 'é©åº¦';
            } else {
                strength = currentLanguage === 'zh' ? 'æ·¡' : currentLanguage === 'en' ? 'Light' : 'è–„ã„';
            }

            // Calculate quality score (å“è³ªè©•åˆ†)
            let quality = 85;
            if (temperature >= 90 && temperature <= 96) quality += 5;
            if (brewTime >= 150 && brewTime <= 240) quality += 5;
            if (ratio >= 13 && ratio <= 16) quality += 5;

            // Generate suggestion
            let suggestion = '';
            if (currentLanguage === 'zh') {
                if (ratio < 12) suggestion = 'æ¯”ä¾‹è¼ƒæ¿ƒï¼Œå¯å¢åŠ æ°´é‡';
                else if (ratio > 16) suggestion = 'æ¯”ä¾‹è¼ƒæ·¡ï¼Œå¯å¢åŠ è±†é‡';
                else suggestion = 'æ¯”ä¾‹é©ä¸­ï¼Œå»ºè­°ç¶­æŒ';
            } else if (currentLanguage === 'en') {
                if (ratio < 12) suggestion = 'Too strong, add more water';
                else if (ratio > 16) suggestion = 'Too light, add more beans';
                else suggestion = 'Good ratio, maintain';
            } else {
                if (ratio < 12) suggestion = 'æ¿ƒã™ãã‚‹ã€æ°´ã‚’å¢—ã‚„ã™';
                else if (ratio > 16) suggestion = 'è–„ã™ãã‚‹ã€è±†ã‚’å¢—ã‚„ã™';
                else suggestion = 'è‰¯ã„æ¯”ç‡ã€ç¶­æŒã™ã‚‹';
            }

            const results = [
                { param: t.resultRatio, value: `1:${ratio}`, recommend: '1:13 - 1:16' },
                { param: t.resultStrength, value: strength, recommend: currentLanguage === 'zh' ? 'é©ä¸­' : currentLanguage === 'en' ? 'Medium' : 'é©åº¦' },
                { param: t.resultQuality, value: `${quality}%`, recommend: 'â‰¥85%' },
                { param: t.resultSuggestion, value: suggestion, recommend: '-' }
            ];

            const tbody = document.getElementById('resultsBody');
            tbody.innerHTML = '';
            results.forEach(result => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${result.param}</td>
                    <td>${result.value}</td>
                    <td>${result.recommend}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function saveSettings() {
            const settings = {
                language: currentLanguage,
                theme: currentTheme,
                beanType: document.getElementById('beanType').value,
                roastLevel: document.getElementById('roastLevel').value,
                beanWeight: document.getElementById('beanWeight').value,
                waterVolume: document.getElementById('waterVolume').value,
                brewTime: document.getElementById('brewTime').value,
                temperature: document.getElementById('temperature').value
            };

            localStorage.setItem('coffeeSettings', JSON.stringify(settings));
            showNotification(translations[currentLanguage].settingsSaved);
        }

        function loadSettings() {
            const saved = localStorage.getItem('coffeeSettings');
            if (saved) {
                const settings = JSON.parse(saved);
                currentLanguage = settings.language || 'zh';
                currentTheme = settings.theme || 'light';
                
                document.getElementById('languageSelector').value = currentLanguage;
                document.getElementById('themeSelector').value = currentTheme;
                document.getElementById('beanType').value = settings.beanType || 'arabica';
                document.getElementById('roastLevel').value = settings.roastLevel || 'medium';
                document.getElementById('beanWeight').value = settings.beanWeight || 18;
                document.getElementById('waterVolume').value = settings.waterVolume || 250;
                document.getElementById('brewTime').value = settings.brewTime || 180;
                document.getElementById('temperature').value = settings.temperature || 93;

                changeTheme();
                changeLanguage();
            }
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function exportToExcel() {
            const data = getCurrentData();
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Coffee Data");
            XLSX.writeFile(wb, "coffee-dashboard-data.xlsx");
            showNotification(translations[currentLanguage].exportSuccess);
        }

        function exportToCSV() {
            const data = getCurrentData();
            let csv = '';
            data.forEach(row => {
                csv += row.join(',') + '\n';
            });
            
            // Add BOM (Byte Order Mark) to ensure proper UTF-8 encoding in Excel
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'coffee-dashboard-data.csv';
            link.click();
            showNotification(translations[currentLanguage].exportSuccess);
        }

        function generateHTMLExport(data) {
            let html = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Coffee Dashboard Export</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #4a90e2; color: white; }
        h1 { color: #333; }
    </style>
</head>
<body>
    <h1>â˜• Coffee Dashboard Export</h1>
    <p>Export Date: ${new Date().toLocaleString()}</p>
    <table>`;
            
            data.forEach((row, index) => {
                html += '<tr>';
                row.forEach(cell => {
                    html += index === 0 ? `<th>${cell}</th>` : `<td>${cell}</td>`;
                });
                html += '</tr>';
            });
            
            html += `</table></body></html>`;
            return html;
        }

        function exportToHTML() {
            const data = getCurrentData();
            const html = generateHTMLExport(data);
            
            const blob = new Blob([html], { type: 'text/html' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'coffee-dashboard-data.html';
            link.click();
            showNotification(translations[currentLanguage].exportSuccess);
        }

        function exportToZIP() {
            const zip = new JSZip();
            const data = getCurrentData();

            // Add Excel
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Coffee Data");
            const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
            zip.file("coffee-dashboard-data.xlsx", excelBuffer);

            // Add CSV
            let csv = '';
            data.forEach(row => {
                csv += row.join(',') + '\n';
            });
            // Add BOM (Byte Order Mark) to ensure proper UTF-8 encoding in Excel
            zip.file("coffee-dashboard-data.csv", '\ufeff' + csv);

            // Add HTML
            const html = generateHTMLExport(data);
            zip.file("coffee-dashboard-data.html", html);

            // Generate ZIP
            zip.generateAsync({ type: 'blob' }).then(function(content) {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(content);
                link.download = 'coffee-dashboard-export.zip';
                link.click();
                showNotification(translations[currentLanguage].exportSuccess);
            });
        }

        function getCurrentData() {
            const t = translations[currentLanguage];
            return [
                [t.paramBeanType, t.paramRoastLevel, t.paramBeanWeight, t.paramWaterVolume, t.paramBrewTime, t.paramTemperature],
                [
                    document.getElementById('beanType').options[document.getElementById('beanType').selectedIndex].text,
                    document.getElementById('roastLevel').options[document.getElementById('roastLevel').selectedIndex].text,
                    document.getElementById('beanWeight').value,
                    document.getElementById('waterVolume').value,
                    document.getElementById('brewTime').value,
                    document.getElementById('temperature').value
                ],
                [],
                [t.resultParamHeader, t.resultValueHeader, t.resultRecommendHeader],
                ...Array.from(document.getElementById('resultsBody').rows).map(row => 
                    Array.from(row.cells).map(cell => cell.textContent)
                )
            ];
        }
    </script>
</body>
</html>
